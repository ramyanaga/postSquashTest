This is Dan commit 3. Will be in parallel with Ramya commit 3